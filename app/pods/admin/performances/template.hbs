<AdminTitle @title="Past Performances" class="mb-5" />

<div class="mb-3">
  {{#link-to "admin.performances.new" class="btn btn-secondary"}}
    {{fa-icon "plus"}}
    New
  {{/link-to}}
</div>

<table class="table table-hover table-sm">
  <thead>
    <GridHeader @currentSort={{currentSort}} @onColumnClicked={{action "sortPerformances"}} as |Column|>
      <Column @name="title">Title</Column>
      <Column @name="link">Link</Column>
      <Column></Column>
    </GridHeader>
  </thead>
  <tbody>
    {{#each sortedPerformances as |performance index|}}
      <tr>
        <td>{{performance.title}}</td>
        <td>
          <a href={{performance.link}}>{{performance.link}}</a>
        </td>
        <td>
          <div class="dropdown float-right show">
            <a class="btn btn-secondary btn-sm dropdown-toggle" href="#" role="button" id="performanceMenu{{index}}" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              {{fa-icon "cog"}}
            </a>
            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="performanceMenu{{index}}">
              {{#link-to 'admin.performances.edit' performance.id class="dropdown-item"}}
                {{fa-icon "pencil"}}
                Edit
              {{/link-to}}
              <a class="dropdown-item" href="#" {{action "delete" performance}}>
                {{fa-icon "trash"}}
                Delete
              </a>
            </div>
          </div>
        </td>
      </tr>
    {{/each}}
  </tbody>
</table>

{{#if showDeleteModal}}
  <ModalDialog as |Modal|>
    <Modal.header @close={{action "cancelDelete"}}>
      Delete Performance?
    </Modal.header>
    <Modal.body>
      {{#if errorMessage}}
        <div class="alert alert-danger">{{errorMessage}}</div>
      {{/if}}
      <p class="form-info">
        <strong>Do you really want to delete this performance?</strong>
      </p>
      <div class="form-group row">
        <label class="col-sm-3 col-form-label">Title</label>
        <div class="col-sm-9">
          <p class="form-control-static">{{performanceToDelete.title}}</p>
        </div>
      </div>
      <div class="form-group row">
        <label class="col-sm-3 col-form-label">Link</label>
        <div class="col-sm-9">
          <p class="form-control-static">{{performanceToDelete.link}}</p>
        </div>
      </div>
    </Modal.body>
    <Modal.footer>
      <button type="button" class="btn btn-secondary" {{action "cancelDelete"}}>No</button>
      <TaskButton class="btn btn-primary" @task={{deletePerformance}} @disabled={{deleteDisabled}}>
        Yes
      </TaskButton>
    </Modal.footer>
  </ModalDialog>
{{/if}}

{{outlet}}
