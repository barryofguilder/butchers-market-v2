<Admin::Components::AdminForm class="max-w-xl" @onSubmit={{perform this.saveEvent}} as |Form|>
  {{#if this.errorMessage}}
    <UiAlert data-test-id="server-error" @variant="danger">
      {{this.errorMessage}}
    </UiAlert>
  {{/if}}

  <p class="mb-8">
    <strong>Note:</strong> Required fields are marked with an <Admin::Components::Required />
  </p>

  <Form.group data-test-id="title" @model={{this.changeset}} @property="title" as |Group|>
    <Group.label>Title <Admin::Components::Required /></Group.label>
    <Group.textbox @value={{this.changeset.title}} />
  </Form.group>

  <Form.group data-test-id="lead-in" @model={{this.changeset}} @property="leadIn" as |Group|>
    <Group.label>Lead In</Group.label>
    <Group.textbox @value={{this.changeset.leadIn}} />
  </Form.group>

  <Form.group data-test-id="date" @model={{this.changeset}} @property="startTime" as |Group|>
    <Group.label>Date <Admin::Components::Required /></Group.label>
    <Group.datepicker
      @disableMobile={{true}}
      @allowInput={{false}}
      @appendDataInput={{true}}
      @date={{readonly this.changeset.startTime}}
      @dateFormat="m/d/Y"
      @onChange={{action "dateSelected"}}
    />
  </Form.group>

  <Form.group data-test-id="end-time" @model={{this.changeset}} @property="endTime" as |Group|>
    <Group.label>End Time <Admin::Components::Required /></Group.label>
    <Group.datepicker
      @disableMobile={{true}}
      @date={{readonly this.changeset.endTime}}
      @enableTime={{true}}
      @noCalendar={{true}}
      @time_24hr={{false}}
      @dateFormat="h:i K"
      @onChange={{action "endTimeSelected"}}
    />
  </Form.group>

  <Form.group data-test-id="link" @model={{this.changeset}} @property="link" as |Group|>
    <Group.label>Link</Group.label>
    <Group.textbox @value={{this.changeset.link}} />
  </Form.group>

  <Form.group data-test-id="image" @model={{this.changeset}} @property="imageUrl" as |Group|>
    <Group.label>Image</Group.label>
    <div class="mt-2">
      <FileUpload
        @id={{Group.uniqueId}}
        @name="photos"
        @accept="image/*"
        @onfileadd={{action "uploadImage"}}
      >
        <a
          class="inline-block px-4 py-2 text-sm border cursor-pointer hover:bg-gray-200 focus:outline-none focus:shadow-outline"
          tabindex="0"
        >
          Select Image
        </a>
      </FileUpload>

      {{#if this.changeset.imageUrl}}
        <button
          type="button"
          class="inline-block ml-2 px-4 py-2 text-sm border cursor-pointer hover:bg-gray-200 focus:outline-none focus:shadow-outline"
          {{action (mut this.changeset.imageUrl) null}}
        >
          Remove Image
        </button>
      {{/if}}

      {{#if this.fileErrorMessage}}
        <span class="block mt-2 text-red-500">
          This is an error message.
          {{this.fileErrorMessage}}
        </span>
      {{/if}}

      <small
        class="block mt-3 text-gray-700 {{if this.fileErrorMessage "" "sm:inline-block sm:mt-0 sm:ml-2"}}"
      >
        Only JPG, JPEG, PNG, and GIF files are allowed.
      </small>

      {{#if this.changeset.imageUrl}}
        <div class="mt-4">
          <img src={{this.changeset.imageUrl}} alt="Event image" class="w-full block">
        </div>
      {{/if}}
    </div>
  </Form.group>

  <div class="mt-8">
    {{#if this.changeset.errors}}
      <div class="mb-2 text-red-600">
        Please fix the errors above and try again.
      </div>
    {{/if}}
    <Form.submit @disabled={{this.saveDisabled}}>
      Save
    </Form.submit>
    <Button class="ml-2" @variant="plain" @onClick={{action cancelled}}>Cancel</Button>
  </div>
</Admin::Components::AdminForm>
