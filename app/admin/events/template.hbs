<AdminTitle @title="Events" class="mb-5" />

<div class="mb-3">
  {{#link-to "admin.events.new" class="btn btn-secondary"}}
    {{fa-icon "plus"}}
    New
  {{/link-to}}

  <div class="btn-group float-right" role="group" aria-label="Event filters">
    <button type="button" class="btn btn-light {{pastClass}}" {{action "filterEvents" "past"}}>Past</button>
    <button type="button" class="btn btn-light {{upcomingClass}}" {{action "filterEvents" "upcoming"}}>Upcoming</button>
    <button type="button" class="btn btn-light {{allClass}}" {{action "filterEvents"}}>All</button>
  </div>
</div>

<table class="table table-hover table-sm">
  <thead>
    <GridHeader @currentSort={{currentSort}} @onColumnClicked={{action "sortEvents"}} as |Column|>
      <Column @name="startTime">Date</Column>
      <Column class="col-time">Time</Column>
      <Column @name="title">Title</Column>
      <Column @name="leadIn">Lead In</Column>
      <Column></Column>
    </GridHeader>
  </thead>
  <tbody>
    {{#each sortedEvents as |event index|}}
      <tr>
        <td>
          {{moment-format event.startTime "MM/DD/YYYY"}}
        </td>
        <td>
          {{moment-format event.startTime "h:mma"}} - {{moment-format event.endTime "h:mma"}}
        </td>
        <td>
          {{#if event.link}}
            <a href="{{event.link}}" target="_blank">{{event.title}}</a>
          {{else}}
            {{event.title}}
          {{/if}}
        </td>
        <td>{{event.leadIn}}</td>
        <td>
          <div class="dropdown float-right show">
            <a class="btn btn-secondary btn-sm dropdown-toggle" href="#" role="button" id="eventMenu{{index}}" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              {{fa-icon "cog"}}
            </a>
            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="eventMenu{{index}}">
              {{#link-to 'admin.events.edit' event.id class="dropdown-item"}}
                {{fa-icon "pencil"}}
                Edit
              {{/link-to}}
              <a class="dropdown-item" href="#" {{action "delete" event}}>
                {{fa-icon "trash"}}
                Delete
              </a>
            </div>
          </div>
        </td>
      </tr>
    {{/each}}
  </tbody>
</table>

{{#if showDeleteModal}}
  <ModalDialog as |Modal|>
    <Modal.header close={{action "cancelDelete"}}>
      Delete Event?
    </Modal.header>
    <form {{action "deleteEvent" on="submit"}}>
      <Modal.body>
        {{#if errorMessage}}
          <div class="alert alert-danger">
            {{errorMessage}}
          </div>
        {{/if}}
        <p class="form-info">
          <strong>Do you really want to delete this event?</strong>
        </p>
        <div class="form-group row">
          <label class="col-sm-3 col-form-label">Title:</label>
          <div class="col-sm-9">
            <p class="form-control-static">{{eventToDelete.title}}</p>
          </div>
        </div>
        <div class="form-group row">
          <label class="col-sm-3 col-form-label">Lead In:</label>
          <div class="col-sm-9">
            <p class="form-control-static">{{eventToDelete.leadIn}}</p>
          </div>
        </div>
        <div class="form-group row">
          <label class="col-sm-3 col-form-label">Date:</label>
          <div class="col-sm-9">
            <p class="form-control-static">{{moment-format eventToDelete.startTime "MMMM Do YYYY"}}</p>
          </div>
        </div>
        <div class="form-group row">
          <label class="col-sm-3 col-form-label">Start Time:</label>
          <div class="col-sm-9">
            <p class="form-control-static">{{moment-format eventToDelete.startTime "h:mma"}}</p>
          </div>
        </div>
        <div class="form-group row">
          <label class="col-sm-3 col-form-label">End Time:</label>
          <div class="col-sm-9">
            <p class="form-control-static">{{moment-format eventToDelete.endTime "h:mma"}}</p>
          </div>
        </div>
        <div class="form-group row">
          <label class="col-sm-3 col-form-label">Link:</label>
          <div class="col-sm-9">
            <p class="form-control-static">{{eventToDelete.link}}</p>
          </div>
        </div>
      </Modal.body>
      <Modal.footer>
        <button type="button" class="btn btn-secondary" {{action "cancelDelete"}}>No</button>
        <button type="submit" class="btn btn-primary">Yes</button>
      </Modal.footer>
    </form>
  </ModalDialog>
{{/if}}

{{outlet}}
